# コーディング規約 (Coding Convention)

本プロジェクトにおける Java コードの記述基準を定義します。

## 1. クラス作成基準

### 1.1 Record の活用
- データを保持することを主な目的とする不変（Immutable）なクラスには、積極的に `record` を使用してください。
- ボイラープレートコード（getter、equals、hashCode、toString）を削減し、コードの意図を明確にします。

### 1.2 final の活用
- 変数、メソッド、クラスに対して、変更を想定しない箇所には積極的に `final` 修飾子を付与してください。
- 意図しない再代入や継承を防ぎ、コードの安全性と可読性を向上させます。
- 特に、不変性を保つべきフィールドや、オーバーライドを禁止したいメソッドに適用します。

### 1.3 名前付け規則
- クラス名は `UpperCamelCase`（例：`World`）を使用します。
- メソッド名、変数名は `lowerCamelCase`（例：`updateWorld`）を使用します。
- 定数（`static final` フィールド）は `UPPER_SNAKE_CASE`（例：`MAX_SIZE`）を使用します。

## 2. 例外設計・エラーハンドリング

例外設計やエラーハンドリングに関する方針については、[エラーハンドリング方針](Error-Handling-Policy.md)を参照してください。

### 2.1 公開 API と IO 例外
- クラスの `public` メソッドからは、`IOException` を直接スローしないようにしてください。
- 低レイヤーの IO 例外は、そのクラスが属するレイヤーに適した独自の実行時例外（例：`UncheckedIOException` やプロジェクト固有の `AppException`）にラップして再スローするか、適切に内部で処理してください。
- これにより、呼び出し元が特定の IO 実装に依存することを防ぎ、コードの凝集度を高めます。

### 2.2 検査例外の回避
- 回復不能なエラーには実行時例外（`RuntimeException` の継承クラス）を使用し、過度な `throws` 宣言を避けてください。

## 3. その他のプラクティス

### 3.1 リアクティブプログラミングの活用
- Spring WebFlux と Project Reactor (`Mono`, `Flux`) を積極的に使用してください。
- ブロッキング I/O を避け、非同期・ノンブロッキングなデータフローを構築します。
- `subscribe()` を直接呼び出すのではなく、フレームワーク（Controller 等）に購読を任せるようにします。

### 3.2 Null の取り扱い
- メソッドの引数や戻り値で `null` を極力使用しないようにしてください。
- 戻り値が空であることを示す場合は、`Optional<T>` を活用するか、空のコレクション/リストを返してください。

### 3.3 コレクションの不変性
- メソッドからコレクションを返す際は、呼び出し元による予期せぬ変更を防ぐため、`List.copyOf()` や `Collections.unmodifiableList()` を使用して不変な状態で返してください。

### 3.4 Import 文の記述
- ワイルドカード（`*`）を使用したパッケージ単位の import は行わないでください。
- インポートするクラスの数に関わらず、個別のクラスや `static` メソッドごとに import 文を記述してください。
- これにより、依存関係を明確にし、名前の衝突を回避します。
- **Import 文のソートとグルーピング**：
  - 以下の順序で記述し、各グループの間には空行を挿入してください。
    1. プロジェクト固有のクラス
    2. 3rdライブラリ等の他クラス
    3. 空白行
    4. `javax.*`
    5. `java.*`
    6. 空白行
    7. `import static` (すべての static import)

### 3.5 Stream API の活用
- ロジックを組み立てる部分（特にコレクションの操作、フィルタリング、変換など）では、`Stream` クラス（Stream API）を積極的に使用してください。
- 宣言的な記述により、コードの可読性と保守性を向上させます。
