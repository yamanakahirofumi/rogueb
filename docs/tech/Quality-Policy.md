# 品質方針（Quality Policy）

本ドキュメントは、本プロジェクトにおける「品質」への考え方と、開発フェーズごとの到達目標の違いを定義します。テストの具体的な作法は「テストルール」を参照し、本書では品質の考え方・優先順位・判断基準を示します。

関連ドキュメント：
- [テストルール](Test-Rule.md)
- [JUnit 5 利用ルール](../implementation/JUnit-Rule.md)
- [CI 設定](CI-Setting.md)
- [コーディング規約](Coding-Convention.md)

## 1. 基本方針
- プロダクト価値の最大化を第一とし、「仕様の明確化」と「ユーザー価値の検証」を優先します。
- 品質はプロダクトのライフサイクルに応じて最適化します。初期は探索速度を、仕様確定後は堅牢性と保守性を重視します。
- 自動化（テスト/CI/静的解析）により、継続的に品質を可視化・維持します。

## 2. フェーズ別の品質目標

### 1. 仕様未確定フェーズ（実装優先）
- 目的：仕様・体験の探索、主要フローの成立確認。
- テスト：メイン機能・主要ハッピーパスを中心に最小限を担保。
- カバレッジ：目標未達でも可（参考指標）。
- 変更：仕様変更頻度が高く、テストの過剰整備は抑制。
- CI：ビルドとスモーク的テストの自動実行で致命的不整合のみ検知。

推奨チェックリスト：
- 主要ユースケースが通ること
- クリティカルなバグ（起動不能、進行不能）がないこと
- 例外時にアプリがクラッシュしないこと（最低限のガード）

### 2. 仕様確定フェーズ（品質目標の達成）
- 目的：安定性・保守性の確保、regressions の抑止。
- テスト：正常系/異常系/境界値を含めて網羅。回帰テストを整備。
- カバレッジ：原則 ラインカバレッジ 80% 以上（プロジェクト標準）。
- 品質ゲート（例）：
  - CI で `mvn verify` 成功（ビルド、テスト、JaCoCo レポート生成）
  - 重要モジュールのレビュー完了
  - 複雑度の高い箇所へ重点テスト（分岐・例外系）

## 3. 判断ガイド
- 新機能が探索段階か、仕様確定後かを常に明示する（Issue/PR に記載）。
- 仕様未確定フェーズでは、テストの欠落は許容するが、後追いでの整備タスクを起票する。
- 仕様確定後は、品質ゲート未達（例：カバレッジ未達、テスト不備）のままマージしない。

## 4. 運用
- CI は常に有効化し、`mvn verify` によりビルド/テスト/カバレッジを自動実行（[CI 設定](CI-Setting.md) 参照）。
- カバレッジレポートは `target/site/jacoco/index.html` を標準とする。
- テスト設計・記述は [テストルール](Test-Rule.md) および [JUnit 5 利用ルール](../implementation/JUnit-Rule.md) に準拠。

## 5. 例外と見直し
- スケジュール/リスク/コスト等の理由で一時的に品質ゲートを緩和する場合、根拠・期限・追従計画を Issue/PR に明記します。
- プロジェクトの成熟度に応じて、本方針を定期的に見直します。